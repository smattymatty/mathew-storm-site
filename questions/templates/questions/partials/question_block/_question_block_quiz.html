{% comment %} questions/templates/questions/partials/question_block/_question_block_quiz.html {% endcomment %}
{% load spellbook_tags %}

<div class="quiz-question-item sb-card sb-mb-4 sb-p-4 sb-border sb-rounded-md sb-bg-white"
     id="question-block-{{ question.pk }}"
     data-question-index="{{ forloop.counter0 }}"
     data-question-id="{{ question.pk }}"
     style="{% if not forloop.first %}display: none;{% endif %}">

    <!-- Header with question number and difficulty -->
    <div class="question-header sb-mb-4">
        <div class="sb-flex sb-justify-between sb-items-start sb-mb-2">
            <h3 class="sb-text-lg sb-font-semibold">
                Question {{ forloop.counter }} of {{ quiz_questions|length }}
            </h3>
            <span class="difficulty-badge sb-px-2 sb-py-1 sb-text-xs sb-rounded sb-bg-{{ question.difficulty_level }}-100 sb-text-{{ question.difficulty_level }}-800">
                {{ question.difficulty_level|title }}
            </span>
        </div>
    </div>

    <!-- Reuse existing question text partial -->
    {% include "questions/partials/question_block/parts/_question_text_htmx.html" with question=question %}

    <!-- Reuse existing question options partial -->
    {% include "questions/partials/question_block/parts/_question_options_htmx.html" with question=question %}

    <!-- Quiz-specific actions (JavaScript-based instead of HTMX) -->
    <div class="question-actions sb-flex sb-justify-center sb-mt-4">
        <button class="check-answer-btn sb-btn sb-btn-primary"
                data-question-id="{{ question.pk }}"
                data-correct-answer="{{ question.correct_answer|lower }}">
            Check Answer
        </button>
    </div>

    <!-- Feedback area -->
    <div class="answer-feedback sb-mt-4" style="display: none;">
        <!-- Feedback will be inserted here via JavaScript -->
    </div>

    <!-- Question ID for reference -->
    <p class="sb-text-xs sb-black-50 sb-mt-3">
        <small>ID: {{ question.question_id_slug }}</small>
    </p>
</div>
